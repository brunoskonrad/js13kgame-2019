!function(){"use strict";let t,i,e={};function h(t,...i){e[t]&&e[t].map(t=>t(...i))}function n(){return i}let s={},r={},o={13:"enter",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"};function a(t){let i=o[t.which];r[i]=!0,s[i]&&s[i](t)}function c(t){r[o[t.which]]=!1}function d(){r={}}function u(t){return!!r[t]}class l{constructor(t,i){this._x=t||0,this._y=i||0}add(t,i){return y(this.x+(t.x||0)*(i||1),this.y+(t.y||0)*(i||1))}clamp(t,i,e,h){this._c=!0,this._a=t,this._b=i,this._d=e,this._e=h}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?Math.min(Math.max(this._a,t),this._d):t}set y(t){this._y=this._c?Math.min(Math.max(this._b,t),this._e):t}}function y(t,i){return new l(t,i)}y.prototype=l.prototype,y.class=l;class x{constructor(t){this.init(t)}init(t={}){let{x:i,y:e,dx:h,dy:s,ddx:r,ddy:o,width:a,height:c,image:d}=t;this.position=y(i,e),this.velocity=y(h,s),this.acceleration=y(r,o),this.width=this.height=this.rotation=0,this.ttl=1/0,this.anchor={x:0,y:0},this.context=n();for(let i in t)this[i]=t[i];d&&(this.width=void 0!==a?a:d.width,this.height=void 0!==c?c:d.height)}get x(){return this.position.x}get y(){return this.position.y}get dx(){return this.velocity.x}get dy(){return this.velocity.y}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}get animations(){return this._a}set x(t){this.position.x=t}set y(t){this.position.y=t}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}set animations(t){let i,e;for(i in this._a={},t)this._a[i]=t[i].clone(),e=e||this._a[i];this.currentAnimation=e,this.width=this.width||e.width,this.height=this.height||e.height}isAlive(){return this.ttl>0}collidesWith(t){if(this.rotation||t.rotation)return null;let i=this.x-this.width*this.anchor.x,e=this.y-this.height*this.anchor.y,h=t.x,n=t.y;return t.anchor&&(h-=t.width*t.anchor.x,n-=t.height*t.anchor.y),i<h+t.width&&i+this.width>h&&e<n+t.height&&e+this.height>n}update(t){this.advance(t)}render(){this.draw()}playAnimation(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}advance(t){this.velocity=this.velocity.add(this.acceleration,t),this.position=this.position.add(this.velocity,t),this.ttl--,this.currentAnimation&&this.currentAnimation.update(t)}draw(){let t=-this.width*this.anchor.x,i=-this.height*this.anchor.y;this.context.save(),this.context.translate(this.x,this.y),this.rotation&&this.context.rotate(this.rotation),this.image?this.context.drawImage(this.image,0,0,this.image.width,this.image.height,t,i,this.width,this.height):this.currentAnimation?this.currentAnimation.render({x:t,y:i,width:this.width,height:this.height,context:this.context}):(this.context.fillStyle=this.color,this.context.fillRect(t,i,this.width,this.height)),this.context.restore()}}function f(t){return new x(t)}f.prototype=x.prototype,f.class=x;const g=()=>{};function p(){let i=t;n().clearRect(0,0,i.width,i.height)}var m=function(e){if(!(t=document.getElementById(e)||e||document.querySelector("canvas")))throw Error("You must provide a canvas element for the game");return(i=t.getContext("2d")).imageSmoothingEnabled=!1,h("init"),{canvas:t,context:i}}().canvas;!function(){let t;for(t=0;t<26;t++)o[65+t]=(10+t).toString(36);for(t=0;t<10;t++)o[48+t]=""+t;window.addEventListener("keydown",a),window.addEventListener("keyup",c),window.addEventListener("blur",d)}();var w=50,v=[];[[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1]].forEach(function(t,i){t.forEach(function(t,e){var h,n;1===t&&v.push((void 0===(h=50*e)&&(h=0),void 0===(n=50*i)&&(n=0),f({x:h,y:n,type:"platform",width:w,height:w,color:"darkgray"})))})});var _=f({type:"player",x:350,y:600,color:"salmon",width:w,height:w,dy:5,moveRight:function(){this.dx=5},moveLeft:function(){this.dx=-5},update:function(){var t=this;this.advance(),this.x+this.width>m.width&&(this.dx=0,this.x=m.width-this.width),this.x<0&&(this.dx=0,this.x=0);var i=v.filter(function(i){return function(t,i){var e=t.y+t.height;if(e>=i.y&&e<i.y+10&&t.x+t.width>i.x&&t.x<i.x+i.width)return!0}(t,i)}).length>0;this.dy=i?0:5}});(function({fps:t=60,clearCanvas:i=!0,update:e,render:n}={}){if(!e||!n)throw Error("You must provide update() and render() functions");let s,r,o,a,c,d=0,u=1e3/t,l=1/t,y=i?p:g;function x(){if(r=requestAnimationFrame(x),o=performance.now(),a=o-s,s=o,!(a>1e3)){for(h("tick"),d+=a;d>=u;)c.update(l),d-=u;y(),c.render()}}return c={update:e,render:n,isStopped:!0,start(){s=performance.now(),this.isStopped=!1,requestAnimationFrame(x)},stop(){this.isStopped=!0,cancelAnimationFrame(r)},_frame:x,set _last(t){s=t}}})({update:function(){!function(t){u("up")&&(t.dy=-5),u("right")&&t.moveRight(),u("left")&&t.moveLeft(),(!u("left")&&!u("right")||u("left")&&u("right"))&&(t.dx=0)}(_),_.update()},render:function(){_.render(),v.forEach(function(t){return t.render()})}}).start()}();